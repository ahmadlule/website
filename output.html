<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Webhook Trigger</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 500px; margin: auto; }
    input, button, textarea { width: 100%; margin-top: 10px; padding: 10px; }
    button { background-color: #4CAF50; color: white; border: none; cursor: pointer; }
    button:hover { background-color: #45a049; }
  </style>
</head>
<body>
  <h2>Send Message to n8n</h2>
  
  <input type="text" id="inputText" placeholder="Enter your message here" />
  <button onclick="sendToWebhook()">Send</button>

  <h3>Response from n8n:</h3>
  <textarea id="outputText" rows="5" readonly></textarea>

  <script>
    async function sendToWebhook() {
      const message = document.getElementById("inputText").value;
      const output = document.getElementById("outputText");

      output.value = "Fetching tunnel URL...";

      try {
        const res = await fetch("domainurl.txt");
        if (!res.ok) throw new Error("Could not fetch domainurl.txt");
        
        const domain = (await res.text()).trim();
        const webhookUrl = `${domain}/webhook-test/local`;

        output.value = "Sending data to: " + webhookUrl;

        const response = await fetch(webhookUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message })
        });

        if (!response.ok) {
          const err = await response.text();
          throw new Error("Webhook error: " + err);
        }

        const data = await response.json();
        output.value = JSON.stringify(data, null, 2);

      } catch (err) {
        output.value = "‚ùå " + err.message;
      }
    }
  </script>
</body>
</html>
